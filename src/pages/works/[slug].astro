---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { SectionTitle } from "@/components/ui/section-title";
import { Image } from "astro:assets";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
---

<Layout title={project.data.title}>
  <main class="container mx-auto px-4 py-8">
    <article>
      <div class="flex flex-col md:flex-row gap-12 w-full mb-6 md:mb-12">
        <header class="flex flex-col gap-8 md:w-2/3">
          <SectionTitle label="Title">
            <h1 class="text-3xl">{project.data.title}</h1>
          </SectionTitle>
          <SectionTitle label="Date">
            <p class="text-sm text-muted-foreground">
              {
                project.data.date.toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })
              }
            </p>
          </SectionTitle>
          <SectionTitle label="Categories">
            {
              project.data.categories.map((category: string, index: number) => (
                <span class="text-3xl">
                  {category}
                  {index < project.data.categories.length - 1 && (
                    <span class="text-muted-foreground -ms-3">,</span>
                  )}
                </span>
              ))
            }
          </SectionTitle>
        </header>
        <div class="md:w-2/3">
          <SectionTitle label="Details">
            <p><Content /></p>
          </SectionTitle>
        </div>
      </div>
      {
        project.data.images && (
          <div class="flex flex-col gap-4">
            {project.data.images.map((image) => (
              <div class="rounded-2xl overflow-hidden">
                <Image
                  src={image}
                  alt={project.data.title}
                  class="w-full h-auto object-cover"
                  width={1000}
                  height={1000}
                />
              </div>
            ))}
          </div>
        )
      }
    </article>
  </main>
</Layout>
