---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import CategoryList from "@/components/ui/category-list.astro";
import { loadFirstWorkImage, loadWorkHeroImage } from "@/lib/load-work-images";

interface Props {
	work: CollectionEntry<"works">;
}

const { work } = Astro.props;

const firstImage = loadFirstWorkImage(work.slug);
const heroImage = loadWorkHeroImage(work.slug);
const image = heroImage || firstImage;
---

<div class="group flex flex-col gap-4">
	<a href={`/works/${work.slug}`}>
		{
			image && (
				<div class="bg-secondary relative aspect-[4/3] w-full overflow-hidden rounded-xl transition-transform duration-300 group-hover:-translate-y-1.5">
					<Image
						src={image}
						alt={work.data.title}
						loading="lazy"
						class="absolute inset-0 h-full w-full object-cover"
					/>
				</div>
			)
		}
		<div class="flex flex-col">
			<h1 class="text-2xl font-medium">
				{work.data.title}
			</h1>
			<CategoryList
				categories={work.data.categories}
				basePath="/works"
				class="text-muted-foreground font-accent text-sm"
				asLinks={true}
			/>
		</div>
	</a>
</div>
