---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import CategoryList from "@/components/ui/category-list.astro";
import { loadFirstWorkImage, loadWorkHeroImage } from "@/lib/load-work-images";

interface Props {
	work: CollectionEntry<"works">;
}

const { work } = Astro.props;

const firstImage = loadFirstWorkImage(work.slug);
const heroImage = loadWorkHeroImage(work.slug);
const image = heroImage || firstImage;
---

<div class="group flex flex-col">
	<a href={`/works/${work.slug}`} class="space-y-6">
		{
			image && (
				<div class="bg-secondary relative aspect-[4/3] w-full overflow-hidden rounded-lg transition-transform duration-300 group-hover:-translate-y-1.5">
					<Image
						src={image}
						alt={work.data.title}
						loading="lazy"
						class="absolute inset-0 h-full w-full object-cover"
					/>
				</div>
			)
		}
		<h1 class="mb-4 text-2xl font-medium">
			{work.data.title}
		</h1>
		<div class="inline-flex flex-row gap-4 text-sm">
			<time datetime={work.data.date.toISOString()} class="font-accent text-sm whitespace-nowrap">
				{
					work.data.date.toLocaleDateString("en-US", {
						year: "numeric",
					})
				}
			</time>
			<CategoryList
				categories={work.data.categories}
				basePath="/works"
				class="text-muted-foreground font-accent text-sm"
				asLinks={true}
			/>
		</div>
	</a>
</div>
