---
import { WorksCategory, WritingCategory } from "@/config/categories";
import { capitalize, getCategoryPath, normalizePath } from "@/lib/utils";
import { collections } from "@/content/config";
import CategorySelectorLink from "./category-selector-link.astro";

type CollectionType = keyof typeof collections;

interface Props {
	type: CollectionType;
}

const { type } = Astro.props;
const currentPath = Astro.url.pathname;
const allPath = normalizePath(type === "works" ? "/" : `/${type}`);
const allIsActive = normalizePath(currentPath) === allPath;

const categoryMap = {
	works: WorksCategory,
	writing: WritingCategory,
} as const;

const categories = Object.values(categoryMap[type]);

const isActive = (category: string) => {
	return normalizePath(currentPath).includes(category.toLowerCase());
};
---

<div class="relative">
	<!-- Gradient edges -->
	<div
		class="from-background pointer-events-none absolute inset-y-0 left-0 z-10 -ml-5 w-5 bg-gradient-to-r to-transparent"
	>
	</div>
	<div
		class="from-background pointer-events-none absolute inset-y-0 right-0 z-10 -mr-5 w-5 bg-gradient-to-l to-transparent"
	>
	</div>

	<!-- Scroll container -->
	<div
		class="scrollbar-none hide-scrollbar -mx-4 touch-auto overflow-x-auto overscroll-contain px-4"
	>
		<ul class="flex min-w-max items-center gap-6 pr-5">
			<li>
				<CategorySelectorLink href={allPath} isActive={allIsActive}> All </CategorySelectorLink>
			</li>
			{
				categories.map((category) => (
					<li>
						<CategorySelectorLink
							href={getCategoryPath(category, `/${type}`)}
							isActive={isActive(category)}
						>
							{capitalize(category)}
						</CategorySelectorLink>
					</li>
				))
			}
		</ul>
	</div>
</div>
